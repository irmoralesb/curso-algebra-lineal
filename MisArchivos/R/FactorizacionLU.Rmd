---
title: "Factorizacion LU"
output: html_document
date: "2024-08-16"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Factorizacion LU

## Uso de la funcion LU() sin permutacion

Devuelve P, L y U

```{R}
A = rbind(c(1,3,0,-1),
          c(2,1,-1,5),
          c(0,-2,3,-1),
          c(1,1,3,1))

lu = LU(A)
```


## lu$P
Como no se ha permutado las filas, es la matriz identidad

```{r}
lu$P
```

## lu$U
Esta es la matriz superior
```{r}
lu$U
```

## lu$L
Esta es la matriz inferior
```{r}
lu$L
```
## Comprobacion
```{r}
lu$L%*%lu$U
```


## Uso de la funcion LU() con permutacion

```{r}
A = rbind(c(0,1,3),
          c(1,3,-2),
          c(-3,-2,-1))

lu = LU(A)
```

```{r}
lu$P
```

```{r}
lu$L
```

```{r}
lu$U
```
```{r}
lu$P%*%A == lu$L%*%lu$U
```

## Solucion de ecuaciones lineales con LU

Se tiene que agregar el termino de vectores independientes


Esto regresa dos vectores extras
1) x que es la solucion del sistema
2) d es el vector solucion del sistema Ld=b, que sirve para resolver Ux = d

Se considera
$.       x2 + 3x3 = 1$
$. x1 + 3x2 - 2x3 = 3$
$-3x1 - 2x2 - x3.  = -2$

```{r}
A = rbind(c(0,1,3),
          c(1,3,-2),
          c(-3,-2,-1))
b = c(1,3,-2)

sistema = LU(A,b)
# Aparece error al ejecutar esto!!!

#A_1 = LU(A)
#X<- solve(A_1,b)
```

## Ejemplos de la ayuda de R que si jalan
```{r}
A <- matrix(c(2, 1, -1,
               -3, -1, 2,
               -2,  1, 2), 3, 3, byrow=TRUE)
  b <- c(8, -11, -3)
  (ret <- LU(A)) # P is an identity; no row swapping
  with(ret, L %*% U) # check that A = L * U
  LU(A, b)
  
  LU(A, b, verbose=TRUE)
  LU(A, b, verbose=TRUE, fractions=TRUE)

  # permutations required in this example
  A <- matrix(c(1,  1, -1,
                2,  2,  4,
                1, -1,  1), 3, 3, byrow=TRUE)
  b <- c(1, 2, 9)
  (ret <- LU(A, b))
  with(ret, P %*% A)
  with(ret, L %*% U)
```

